var http=require("http");
var https=require("https");
var dgram=require("dgram");
var url=require("url");
var querystring = require("querystring");
var streamserver=require("./streamserver.js");
var bbsServer=require("./bbs.js");
var GPS = {
    PI : 3.14159265358979324,
    x_pi : 3.14159265358979324 * 3000.0 / 180.0,
    delta : function (lat, lon) {
        // Krasovsky 1940
        //
        // a = 6378245.0, 1/f = 298.3
        // b = a * (1 - f)
        // ee = (a^2 - b^2) / a^2;
        var a = 6378245.0; //  a: 卫星椭球坐标投影到平面地图坐标系的投影因子。
        var ee = 0.00669342162296594323; //  ee: 椭球的偏心率。
        var dLat = this.transformLat(lon - 105.0, lat - 35.0);
        var dLon = this.transformLon(lon - 105.0, lat - 35.0);
        var radLat = lat / 180.0 * this.PI;
        var magic = Math.sin(radLat);
        magic = 1 - ee * magic * magic;
        var sqrtMagic = Math.sqrt(magic);
        dLat = (dLat * 180.0) / ((a * (1 - ee)) / (magic * sqrtMagic) * this.PI);
        dLon = (dLon * 180.0) / (a / sqrtMagic * Math.cos(radLat) * this.PI);
        return {'lat': dLat, 'lon': dLon};
    },
     
    //WGS-84 to GCJ-02
    gcj_encrypt : function (wgsLat, wgsLon) {
        if (this.outOfChina(wgsLat, wgsLon))
            return {'lat': wgsLat, 'lon': wgsLon};
 
        var d = this.delta(wgsLat, wgsLon);
        return {'lat' : wgsLat + d.lat,'lon' : wgsLon + d.lon};
    },
    //GCJ-02 to WGS-84
    gcj_decrypt : function (gcjLat, gcjLon) {
        if (this.outOfChina(gcjLat, gcjLon))
            return {'lat': gcjLat, 'lon': gcjLon};
         
        var d = this.delta(gcjLat, gcjLon);
        return {'lat': gcjLat - d.lat, 'lon': gcjLon - d.lon};
    },
    //GCJ-02 to WGS-84 exactly
    gcj_decrypt_exact : function (gcjLat, gcjLon) {
        var initDelta = 0.01;
        var threshold = 0.000000001;
        var dLat = initDelta, dLon = initDelta;
        var mLat = gcjLat - dLat, mLon = gcjLon - dLon;
        var pLat = gcjLat + dLat, pLon = gcjLon + dLon;
        var wgsLat, wgsLon, i = 0;
        while (1) {
            wgsLat = (mLat + pLat) / 2;
            wgsLon = (mLon + pLon) / 2;
            var tmp = this.gcj_encrypt(wgsLat, wgsLon)
            dLat = tmp.lat - gcjLat;
            dLon = tmp.lon - gcjLon;
            if ((Math.abs(dLat) < threshold) && (Math.abs(dLon) < threshold))
                break;
 
            if (dLat > 0) pLat = wgsLat; else mLat = wgsLat;
            if (dLon > 0) pLon = wgsLon; else mLon = wgsLon;
 
            if (++i > 10000) break;
        }
        //console.log(i);
        return {'lat': wgsLat, 'lon': wgsLon};
    },
    //GCJ-02 to BD-09
    bd_encrypt : function (gcjLat, gcjLon) {
        var x = gcjLon, y = gcjLat;  
        var z = Math.sqrt(x * x + y * y) + 0.00002 * Math.sin(y * this.x_pi);  
        var theta = Math.atan2(y, x) + 0.000003 * Math.cos(x * this.x_pi);  
        bdLon = z * Math.cos(theta) + 0.0065;  
        bdLat = z * Math.sin(theta) + 0.006; 
        return {'lat' : bdLat,'lon' : bdLon};
    },
    //BD-09 to GCJ-02
    bd_decrypt : function (bdLat, bdLon) {
        var x = bdLon - 0.0065, y = bdLat - 0.006;  
        var z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * this.x_pi);  
        var theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * this.x_pi);  
        var gcjLon = z * Math.cos(theta);  
        var gcjLat = z * Math.sin(theta);
        return {'lat' : gcjLat, 'lon' : gcjLon};
    },
    //WGS-84 to Web mercator
    //mercatorLat -> y mercatorLon -> x
    mercator_encrypt : function(wgsLat, wgsLon) {
        var x = wgsLon * 20037508.34 / 180.;
        var y = Math.log(Math.tan((90. + wgsLat) * this.PI / 360.)) / (this.PI / 180.);
        y = y * 20037508.34 / 180.;
        return {'lat' : y, 'lon' : x};
        /*
        if ((Math.abs(wgsLon) > 180 || Math.abs(wgsLat) > 90))
            return null;
        var x = 6378137.0 * wgsLon * 0.017453292519943295;
        var a = wgsLat * 0.017453292519943295;
        var y = 3189068.5 * Math.log((1.0 + Math.sin(a)) / (1.0 - Math.sin(a)));
        return {'lat' : y, 'lon' : x};
        //*/
    },
    // Web mercator to WGS-84
    // mercatorLat -> y mercatorLon -> x
    mercator_decrypt : function(mercatorLat, mercatorLon) {
        var x = mercatorLon / 20037508.34 * 180.;
        var y = mercatorLat / 20037508.34 * 180.;
        y = 180 / this.PI * (2 * Math.atan(Math.exp(y * this.PI / 180.)) - this.PI / 2);
        return {'lat' : y, 'lon' : x};
        /*
        if (Math.abs(mercatorLon) < 180 && Math.abs(mercatorLat) < 90)
            return null;
        if ((Math.abs(mercatorLon) > 20037508.3427892) || (Math.abs(mercatorLat) > 20037508.3427892))
            return null;
        var a = mercatorLon / 6378137.0 * 57.295779513082323;
        var x = a - (Math.floor(((a + 180.0) / 360.0)) * 360.0);
        var y = (1.5707963267948966 - (2.0 * Math.atan(Math.exp((-1.0 * mercatorLat) / 6378137.0)))) * 57.295779513082323;
        return {'lat' : y, 'lon' : x};
        //*/
    },
    // two point's distance
    distance : function (latA, lonA, latB, lonB) {
        var earthR = 6371000.;
        var x = Math.cos(latA * this.PI / 180.) * Math.cos(latB * this.PI / 180.) * Math.cos((lonA - lonB) * this.PI / 180);
        var y = Math.sin(latA * this.PI / 180.) * Math.sin(latB * this.PI / 180.);
        var s = x + y;
        if (s > 1) s = 1;
        if (s < -1) s = -1;
        var alpha = Math.acos(s);
        var distance = alpha * earthR;
        return distance;
    },
    outOfChina : function (lat, lon) {
        if (lon < 72.004 || lon > 137.8347)
            return true;
        if (lat < 0.8293 || lat > 55.8271)
            return true;
        return false;
    },
    transformLat : function (x, y) {
        var ret = -100.0 + 2.0 * x + 3.0 * y + 0.2 * y * y + 0.1 * x * y + 0.2 * Math.sqrt(Math.abs(x));
        ret += (20.0 * Math.sin(6.0 * x * this.PI) + 20.0 * Math.sin(2.0 * x * this.PI)) * 2.0 / 3.0;
        ret += (20.0 * Math.sin(y * this.PI) + 40.0 * Math.sin(y / 3.0 * this.PI)) * 2.0 / 3.0;
        ret += (160.0 * Math.sin(y / 12.0 * this.PI) + 320 * Math.sin(y * this.PI / 30.0)) * 2.0 / 3.0;
        return ret;
    },
    transformLon : function (x, y) {
        var ret = 300.0 + x + 2.0 * y + 0.1 * x * x + 0.1 * x * y + 0.1 * Math.sqrt(Math.abs(x));
        ret += (20.0 * Math.sin(6.0 * x * this.PI) + 20.0 * Math.sin(2.0 * x * this.PI)) * 2.0 / 3.0;
        ret += (20.0 * Math.sin(x * this.PI) + 40.0 * Math.sin(x / 3.0 * this.PI)) * 2.0 / 3.0;
        ret += (150.0 * Math.sin(x / 12.0 * this.PI) + 300.0 * Math.sin(x / 30.0 * this.PI)) * 2.0 / 3.0;
        return ret;
    },
	GetDistance: function(lat1,lng1,lat2,lng2){
function Rad(d){
           return d * Math.PI / 180.0;//经纬度转换成三角函数中度分表形式。
        }
            var radLat1 = Rad(lat1);
            var radLat2 = Rad(lat2);
            var a = radLat1 - radLat2;
            var  b = Rad(lng1) - Rad(lng2);
            var s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a/2),2) +
            Math.cos(radLat1)*Math.cos(radLat2)*Math.pow(Math.sin(b/2),2)));
            s = s *6378.137 ;// EARTH_RADIUS;
            s = Math.round(s * 10000) / 10000; //输出为公里
            s *= 1000;//输出为米
            return s;
        }
};


function datacollector(port){
this.callback=undefined;
var server=dgram.createSocket('udp4');

server.on("message",(msg,r)=>{
//	res.writeHead(200, {'Content-Type': 'text/html'});
	let u=querystring.parse(msg+"");
//console.log(u);
//console.log("rawdata"+msg);

	//res.end("OK");
	if(this.callback && u && u.id)
		{
		let ms=this.callback(u);
		if(ms)
		server.send(ms,0,ms.length,r.port,r.address);	
		}
	else
		server.send(" ",0,1,r.port,r.address);
});

server.bind(port);

this.ondata=(f)=>{this.callback=f};

}

function world(){
	this.datacollector=new datacollector(1235);
	this.ticker=setInterval(()=>{
		this.tick();
	},100);
	this.bus={};
	this.queue=[];
	this.ticks=0;
	this.nextInstruction={};
	
	this.ImeiSet={
		"866289035582123":{id:"1122",name:"1122车"},
		"866289035475856":{id:"1189",name:"1189车"},
		"866289035484338":{id:"7060",name:"7060车"},
		"866289035474537":{id:"39559",name:"39559车"},
		"866289035461567":{id:"1187",name:"1187车"},
		"866289035476144":{id:"28919",name:"28919车"},
		"866289035475542":{id:"jinshan",name:"金山线"},
		"866289035011305":{id:"5B371",name:"5B371车"},
		"862285033475686":{id:"5B371",name:"5B371"},

		"raspi":{id:"raspi1187",name:"1187车"}
	}
	
	
	this.datacollector.ondata((u)=>{
	//	this.queue.push(u);
		return this.handleData(u);

	});
	
	this.handleData=(u)=>{
//while(this.queue.length>0){
//		let u=this.queue.shift();
//		if(!u)continue;
               if(!this.ImeiSet[u.id]){console.log("未知信号源",u.id);return ""};
			var busid=this.ImeiSet[u.id].id;
			var busname=this.ImeiSet[u.id].name;
			if(!busid)busid=u.id;
		              if(!this.bus[busid])
					  {
this.bus[busid]={actived:0,avgspeed:0,CSpeedSum:[],history:[],lastlat:parseFloat(u.lat),lastlon:parseFloat(u.lon),lat:parseFloat(u.lat),lon:parseFloat(u.lon),fspeed:u.speed,cspeed:0,lastupdateTime:0,updateTime:(new Date()).getTime(),timeout:false,lastexecresult:u.lastexecresult,name:busname,cid:busid};
		
					  }	
                else
                {

//		if(parseFloat(u.lat)==0 || parseFloat(u.lon)==0)return;
	//	if(GPS.GetDistance(u.lat,u.lon,this.bus[busid].lat,this.bus[busid].lon)>500)return;
		if(u.isfixed=="false")return;

		console.log(busid,u.lat,u.lon,u.speed,u.lastexecresult,(u.voltage/1000).toFixed(3)+"V",u.isfixed);

                        this.bus[busid].history.push({lat:this.bus[busid].lat,lon:this.bus[busid].lon,updateTime:this.bus[busid].updateTime})
						
                        this.bus[busid].lat=parseFloat(u.lat);
                        this.bus[busid].lon=parseFloat(u.lon);
//console.log(u);
						this.bus[busid].lastexecresult=u.lastexecresult;
                        this.bus[busid].fspeed=u.speed;
                        this.bus[busid].updateTime=(new Date()).getTime();
						

               }
			  if(this.nextInstruction[busid])
			  {
				  let ret=this.nextInstruction[busid];
					this.nextInstruction[busid]="";
		
				return ret;
			  
			  }else
				  
				  return " ";
//}
		
	
	
	
	}
	this.activate=(id,val)=>{
			this.bus[id].actived+=val;
			if(this.bus[id].actived<=0)
				this.bus[id].actived=0;
		
	}
	this.calc=()=>{
		for(var i in this.bus)
		{
			
			let last=this.bus[i].history[this.bus[i].history.length-1];
			
			
				
			if(last){
				
				if(((new Date()).getTime()-this.bus[i].updateTime)>5*1000)//7秒没有信号就超时
				this.bus[i].timeout=(new Date()).getTime()-this.bus[i].updateTime;
				else
				this.bus[i].timeout=false;
			
		      // if(this.bus[i].updateTime-last.updateTime<5000){

			let delta=
			GPS.GetDistance(this.bus[i].lat,this.bus[i].lon,last.lat,last.lon);

			let lspeed=delta/((this.bus[i].updateTime-last.updateTime)/1000);
			if(Math.abs(lspeed-this.bus[i].fspeed)>3)
			this.bus[i].cspeed=this.bus[i].fspeed*0.277;
			else
			this.bus[i].cspeed=lspeed*0.4+(this.bus[i].fspeed*0.277)*0.6;
//}else this.bus[i].cspeed=this.bus[i].fspeed*0.277;
		//	if(this.bus[i].cspeed!=this.bus[i].CSpeedSum[this.bus[i].CSpeedSum.length-1])
	if(this.bus[i].timeout==false)
		
	this.bus[i].CSpeedSum.push(this.bus[i].cspeed);
			
			
			if(this.bus[i].CSpeedSum.length>=100)	
				this.bus[i].CSpeedSum.shift();
			let sum=0;
			if(this.bus[i].CSpeedSum.length>0)
			{	for(var k in this.bus[i].CSpeedSum)
				sum+=this.bus[i].CSpeedSum[k];
			
			
			this.bus[i].avgspeed=sum/this.bus[i].CSpeedSum.length;
			
			
			}
			
			
			
			
				
			}
			

		
	
		}
		
		
		
	}
	this.tick=()=>{
		this.calc();
		for(var i in this.bus)
		{
			if(this.bus[i].cspeed<2.7)//10km/h
				this.activate(i,-0.2);
			else
			this.bus[i].actived=100;
			
	
		}
		//this.handleData();

	}
	this.whichLineIsBus_gcj02=(id,lines)=>{
		let which=0;
		for(var i in lines)
			if(this.whereIsBUS_gcj02(id,lines[i])>0)

			which=i;

		return which;
		}
	this.whereIsBUS_gcj02=(id,line)=>{//根据一个路线返回某辆BUS在路线的第几站
		let min={i:-1,dis:999999999};
		for(var i in line)
		{
		let distance=this.getBUSLDistance_gcj02(id,line[i]);
//console.log(distance);

		if(distance<min.dis)
			{min.i=i;min.dis=distance};
		}
		
		if(min.dis>100)
		return -parseInt(min.i);//不在路线上
		else
		return parseInt(min.i);
	}
	this.getBUSDistance_gcj02=(id,line,off)=>{//实际需要的路程,off表示路线line的第几站
		let nowoff=this.whereIsBUS_gcj02(id,line);
		let sum=0;

		let min=Math.min(nowoff,off);
		let max=Math.max(nowoff,off);
if(max>line.length-2)
	max=line.length-2;
if(min<=0)
min=0;
	
		if(line[min] && line[max])
		for(let i=min;i<max;i++){
			let de1=GPS.gcj_decrypt(line[i].lat,line[i].lng);
			let de2=GPS.gcj_decrypt(line[i+1].lat,line[i+1].lng);
			
			sum+=GPS.GetDistance(de1.lat,de1.lon,de2.lat,de2.lon);
		}
		
		
		
		return sum;
	}
	
	this.getBUSLDistance_gcj02=(id,target)=>{//直线距离
		let de=GPS.gcj_decrypt(target.lat,target.lng);

		let d1=GPS.GetDistance(this.bus[id].lat,this.bus[id].lon,de.lat,de.lon);
		//let d2=GPS.GetDistance(this.bus[id].lastlat,this.bus[id].lastlon,target.lat,target.lon);
		
		
//		return d2>d1?(-d1):(d1);
		return d1;

	}

	this.getBUS=(id)=>{
		return this.bus[id];
	}
	this.getAllBUS=()=>{
		return this.bus;
	}
	this.instruct=(id,func)=>{
		this.nextInstruction[id]=func;
	}
	
}

function busdataclient(updateRate){
	this.world=new world();
	this.targets=[
		[{loc:0,name:"阳光学院",type:0},
		{loc:109,name:"新华都站",type:1},
		{loc:152,name:"中环广场站",type:2},
		{loc:162,name:"掉头",type:3}],
		
		[{loc:0,name:"阳光学院",type:0},
		{loc:377,name:"金山线终点",type:2}],

		[{loc:0,name:"金山线起点",type:0},
		{loc:394,name:"阳光学院",type:2]

		
	]

	this.redlights=[
			
			101,
			138,
			147
	]
	this.busInfo={};
	this.busBelongLine={
	"1187":[0],
	"1189":[0],
	"28919":[0],
	"1122":[0],
	"39559":[0],
	"7060":[0],
	"jinshan":[1,2],
	"raspi1187":[0],
	"5B371":[0]
	}
	
	this.linesInfo=[
{name:"学生线",type:"student",color:"#FF6600",picwaiting:"../../images/waiting_student.png",picrelax:"../../images/relax_student.png",picdriving:"../../images/driving.png"},
{name:"金山线",type:"teacher",color:"#00FF7F",picwaiting:"../../images/waiting_student.png",picrelax:"../../images/relax_student.png",picdriving:"../../images/driving.png"},
{name:"金山线返程",type:"teacher",color:"#00FF7F",picwaiting:"../../images/waiting_student.png",picrelax:"../../images/relax_student.png",picdriving:"../../images/driving.png"},

];
	this.lines=[[{"lat":26.003066,"lng":119.450907},
{"lat":26.002931,"lng":119.451084},
{"lat":26.002747,"lng":119.451358},
{"lat":26.002579,"lng":119.451631},
{"lat":26.002449,"lng":119.452018},
{"lat":26.002193,"lng":119.452318},
{"lat":26.001899,"lng":119.452205},
{"lat":26.001639,"lng":119.452077},
{"lat":26.001422,"lng":119.451798},
{"lat":26.001209,"lng":119.451422},
{"lat":26.001041,"lng":119.451079},
{"lat":26.000882,"lng":119.450725},
{"lat":26.000650,"lng":119.450328},
{"lat":26.000448,"lng":119.450065},
{"lat":26.000154,"lng":119.449904},
{"lat":25.999898,"lng":119.449545},
{"lat":25.999893,"lng":119.449046},
{"lat":25.999710,"lng":119.448735},
{"lat":25.999498,"lng":119.448418},
{"lat":25.999266,"lng":119.448059},
{"lat":25.999078,"lng":119.447726},
{"lat":25.998905,"lng":119.447410},
{"lat":25.998784,"lng":119.447093},
{"lat":25.998775,"lng":119.446728},
{"lat":25.998808,"lng":119.446353},
{"lat":25.998861,"lng":119.445940},
{"lat":25.998847,"lng":119.445580},
{"lat":25.998775,"lng":119.445183},
{"lat":25.998649,"lng":119.444851},
{"lat":25.998466,"lng":119.444658},
{"lat":25.998273,"lng":119.444513},
{"lat":25.998085,"lng":119.444405},
{"lat":25.997844,"lng":119.444191},
{"lat":25.997680,"lng":119.443837},
{"lat":25.997502,"lng":119.443499},
{"lat":25.997275,"lng":119.443172},
{"lat":25.996952,"lng":119.442844},
{"lat":25.996658,"lng":119.442667},
{"lat":25.996345,"lng":119.442646},
{"lat":25.996046,"lng":119.442732},
{"lat":25.995694,"lng":119.443086},
{"lat":25.995534,"lng":119.443349},
{"lat":25.995332,"lng":119.443665},
{"lat":25.995139,"lng":119.443767},
{"lat":25.994787,"lng":119.443638},
{"lat":25.994435,"lng":119.443349},
{"lat":25.994180,"lng":119.443252},
{"lat":25.993934,"lng":119.443263},
{"lat":25.993683,"lng":119.443359},
{"lat":25.993389,"lng":119.443579},
{"lat":25.993172,"lng":119.443907},
{"lat":25.993042,"lng":119.444143},
{"lat":25.992936,"lng":119.444389},
{"lat":25.992844,"lng":119.444615},
{"lat":25.992748,"lng":119.444802},
{"lat":25.992670,"lng":119.445221},
{"lat":25.992661,"lng":119.445720},
{"lat":25.992661,"lng":119.446106},
{"lat":25.992675,"lng":119.446514},
{"lat":25.992675,"lng":119.446964},
{"lat":25.992916,"lng":119.447388},
{"lat":25.993196,"lng":119.447592},
{"lat":25.993423,"lng":119.447930},
{"lat":25.993533,"lng":119.448343},
{"lat":25.993543,"lng":119.448718},
{"lat":25.993389,"lng":119.449148},
{"lat":25.993157,"lng":119.449523},
{"lat":25.993037,"lng":119.449952},
{"lat":25.992858,"lng":119.450306},
{"lat":25.992535,"lng":119.450414},
{"lat":25.992145,"lng":119.450499},
{"lat":25.991827,"lng":119.450617},
{"lat":25.991619,"lng":119.450821},
{"lat":25.991436,"lng":119.450998},
{"lat":25.991219,"lng":119.451202},
{"lat":25.990973,"lng":119.451347},
{"lat":25.990597,"lng":119.451422},
{"lat":25.990269,"lng":119.451406},
{"lat":25.989734,"lng":119.451374},
{"lat":25.989411,"lng":119.451256},
{"lat":25.989141,"lng":119.450918},
{"lat":25.988851,"lng":119.450644},
{"lat":25.988591,"lng":119.450816},
{"lat":25.988278,"lng":119.451819},
{"lat":25.987776,"lng":119.452087},
{"lat":25.987193,"lng":119.452119},
{"lat":25.986763,"lng":119.452114},
{"lat":25.986657,"lng":119.452838},
{"lat":25.986927,"lng":119.453235},
{"lat":25.987270,"lng":119.453643},
{"lat":25.987299,"lng":119.453976},
{"lat":25.987164,"lng":119.454190},
{"lat":25.987318,"lng":119.454448},
{"lat":25.987598,"lng":119.454668},
{"lat":25.987959,"lng":119.454904},
{"lat":25.988273,"lng":119.455081},
{"lat":25.988649,"lng":119.455274},
{"lat":25.988991,"lng":119.455451},
{"lat":25.989295,"lng":119.455574},
{"lat":25.989555,"lng":119.455789},
{"lat":25.989878,"lng":119.455993},
{"lat":25.990149,"lng":119.456148},
{"lat":25.991108,"lng":119.456722},
{"lat":25.991595,"lng":119.456969},
{"lat":25.992174,"lng":119.457275},
{"lat":25.992622,"lng":119.457505},
{"lat":25.993003,"lng":119.457704},
{"lat":25.993505,"lng":119.457999},
{"lat":25.993625,"lng":119.458203},
{"lat":25.993461,"lng":119.458412},
{"lat":25.993244,"lng":119.458739},
{"lat":25.993071,"lng":119.459002},
{"lat":25.992868,"lng":119.459351},
{"lat":25.992588,"lng":119.459705},
{"lat":25.992434,"lng":119.459994},
{"lat":25.992323,"lng":119.460139},
{"lat":25.992135,"lng":119.460424},
{"lat":25.991870,"lng":119.460831},
{"lat":25.991730,"lng":119.461051},
{"lat":25.991566,"lng":119.461309},
{"lat":25.991817,"lng":119.461496},
{"lat":25.992068,"lng":119.461657},
{"lat":25.992275,"lng":119.461775},
{"lat":25.992424,"lng":119.461920},
{"lat":25.992627,"lng":119.462049},
{"lat":25.992883,"lng":119.462210},
{"lat":25.993080,"lng":119.462349},
{"lat":25.993288,"lng":119.462478},
{"lat":25.993514,"lng":119.462623},
{"lat":25.993770,"lng":119.462800},
{"lat":25.994088,"lng":119.463047},
{"lat":25.994247,"lng":119.463197},
{"lat":25.994546,"lng":119.463417},
{"lat":25.994941,"lng":119.463653},
{"lat":25.995289,"lng":119.463878},
{"lat":25.995568,"lng":119.464071},
{"lat":25.995877,"lng":119.464275},
{"lat":25.996065,"lng":119.464393},
{"lat":25.995983,"lng":119.464720},
{"lat":25.995800,"lng":119.464940},
{"lat":25.995645,"lng":119.465246},
{"lat":25.995428,"lng":119.465514},
{"lat":25.995240,"lng":119.465724},
{"lat":25.995033,"lng":119.465986},
{"lat":25.994782,"lng":119.466442},
{"lat":25.994633,"lng":119.466732},
{"lat":25.994392,"lng":119.466984},
{"lat":25.994208,"lng":119.466839},
{"lat":25.993948,"lng":119.466619},
{"lat":25.993813,"lng":119.466518},
{"lat":25.993601,"lng":119.466373},
{"lat":25.993408,"lng":119.466201},
{"lat":25.993254,"lng":119.466088},
{"lat":25.993032,"lng":119.465901},
{"lat":25.992748,"lng":119.465665},
{"lat":25.992458,"lng":119.465418},
{"lat":25.992179,"lng":119.465139},
{"lat":25.991909,"lng":119.464951},
{"lat":25.991754,"lng":119.464796},
{"lat":25.991581,"lng":119.464699}],



[{"lat":26.0463150304,"lng":119.245807948},{"lat":26.0470590304,"lng":119.245770948},{"lat":26.0470590304,"lng":119.245770948},{"lat":26.0471580304,"lng":119.246950948},{"lat":26.047216030399998,"lng":119.248020948},{"lat":26.047267030399997,"lng":119.24865994800001},{"lat":26.047366030399996,"lng":119.249939948},{"lat":26.047363030399996,"lng":119.250053948},{"lat":26.047416030399997,"lng":119.252078948},{"lat":26.047425030399996,"lng":119.25262294800001},{"lat":26.047443030399997,"lng":119.25326494800001},{"lat":26.047459030399995,"lng":119.25383794800001},{"lat":26.047464030399997,"lng":119.25426694800001},{"lat":26.047484030399996,"lng":119.25475594800001},{"lat":26.047477030399996,"lng":119.255292948},{"lat":26.047486030399995,"lng":119.255728948},{"lat":26.047474030399993,"lng":119.256843948},{"lat":26.047474030399993,"lng":119.257173948},{"lat":26.047464030399993,"lng":119.257552948},{"lat":26.047454030399994,"lng":119.257631948},{"lat":26.047419030399993,"lng":119.258507948},{"lat":26.047408030399993,"lng":119.259220948},{"lat":26.047394030399992,"lng":119.259659948},{"lat":26.047406030399994,"lng":119.261022948},{"lat":26.047389030399994,"lng":119.26224194800001},{"lat":26.047389030399994,"lng":119.26224194800001},{"lat":26.047429030399993,"lng":119.26400894800001},{"lat":26.04745503039999,"lng":119.26459794800002},{"lat":26.04746503039999,"lng":119.26688694800002},{"lat":26.047449030399992,"lng":119.26796094800002},{"lat":26.047501030399992,"lng":119.26839294800003},{"lat":26.047601030399992,"lng":119.26881694800002},{"lat":26.047848030399994,"lng":119.26948194800002},{"lat":26.048241030399993,"lng":119.27045494800002},{"lat":26.048241030399993,"lng":119.27045494800002},{"lat":26.048714030399992,"lng":119.27157894800003},{"lat":26.048850030399993,"lng":119.27178594800003},{"lat":26.04902803039999,"lng":119.27214594800003},{"lat":26.049862030399993,"lng":119.27340394800004},{"lat":26.049862030399993,"lng":119.27340394800004},{"lat":26.04861303039999,"lng":119.27470394800004},{"lat":26.048234030399993,"lng":119.27512294800003},{"lat":26.04686403039999,"lng":119.27622294800003},{"lat":26.04638403039999,"lng":119.27660194800002},{"lat":26.046046030399992,"lng":119.27681194800002},{"lat":26.045975030399994,"lng":119.27683594800001},{"lat":26.045762030399995,"lng":119.27701594800001},{"lat":26.045516030399995,"lng":119.27727094800001},{"lat":26.044366030399996,"lng":119.278149948},{"lat":26.044267030399997,"lng":119.278239948},{"lat":26.044218030399996,"lng":119.27827894800001},{"lat":26.043987030399997,"lng":119.278393948},{"lat":26.0432560304,"lng":119.278902948},{"lat":26.0425900304,"lng":119.279599948},{"lat":26.0425000304,"lng":119.279716948},{"lat":26.0422210304,"lng":119.279976948},{"lat":26.0415310304,"lng":119.280615948},{"lat":26.041121030400003,"lng":119.281065948},{"lat":26.041011030400004,"lng":119.281224948},{"lat":26.040601030400005,"lng":119.281843948},{"lat":26.040601030400005,"lng":119.281843948},{"lat":26.040232030400006,"lng":119.28217394800001},{"lat":26.039943030400007,"lng":119.282502948},{"lat":26.039413030400006,"lng":119.283042948},{"lat":26.036813030400005,"lng":119.285361948},{"lat":26.034833030400005,"lng":119.28708194800001},{"lat":26.033264030400005,"lng":119.28815094800001},{"lat":26.032324030400005,"lng":119.28874094800001},{"lat":26.032005030400004,"lng":119.28892094800001},{"lat":26.031181030400003,"lng":119.28930294800001},{"lat":26.0307860304,"lng":119.28947994800001},{"lat":26.0307860304,"lng":119.28947994800001},{"lat":26.0306960304,"lng":119.289469948},{"lat":26.0305160304,"lng":119.289409948},{"lat":26.0303670304,"lng":119.289300948},{"lat":26.0302170304,"lng":119.288980948},{"lat":26.0297580304,"lng":119.287761948},{"lat":26.0295390304,"lng":119.287281948},{"lat":26.029299030399997,"lng":119.286872948},{"lat":26.029080030399996,"lng":119.286562948},{"lat":26.028800030399996,"lng":119.286203948},{"lat":26.028704030399997,"lng":119.286118948},{"lat":26.028704030399997,"lng":119.286118948},{"lat":26.028551030399996,"lng":119.28597494799999},{"lat":26.027771030399997,"lng":119.28533594799998},{"lat":26.027241030399995,"lng":119.28497594799998},{"lat":26.026922030399994,"lng":119.28481694799999},{"lat":26.026452030399994,"lng":119.28461794799999},{"lat":26.025733030399994,"lng":119.284447948},{"lat":26.025473030399993,"lng":119.28440894799999},{"lat":26.024953030399992,"lng":119.28439994799999},{"lat":26.02414403039999,"lng":119.284419948},{"lat":26.02414403039999,"lng":119.284419948},{"lat":26.02414403039999,"lng":119.28452894799999},{"lat":26.025434030399992,"lng":119.28455894799998},{"lat":26.025753030399994,"lng":119.28460994799998},{"lat":26.025753030399994,"lng":119.28460994799998},{"lat":26.025792030399995,"lng":119.28461794799998},{"lat":26.025792030399995,"lng":119.28461794799998},{"lat":26.025812030399994,"lng":119.28446794799997},{"lat":26.025472030399992,"lng":119.28440794799997},{"lat":26.025292030399992,"lng":119.28439894799996},{"lat":26.02414303039999,"lng":119.28441894799997},{"lat":26.02414303039999,"lng":119.28441894799997},{"lat":26.024013030399992,"lng":119.28447794799996},{"lat":26.02401503039999,"lng":119.28674994799997},{"lat":26.02401503039999,"lng":119.28674994799997},{"lat":26.02403203039999,"lng":119.28768794799997},{"lat":26.02403203039999,"lng":119.28768794799997},{"lat":26.02401203039999,"lng":119.28984694799998},{"lat":26.02398003039999,"lng":119.29093894799998},{"lat":26.02388303039999,"lng":119.29137594799998},{"lat":26.023764030399988,"lng":119.29171594799998},{"lat":26.023674030399988,"lng":119.29193494799998},{"lat":26.02359503039999,"lng":119.29208494799998},{"lat":26.02348503039999,"lng":119.29225394799998},{"lat":26.02302503039999,"lng":119.29286394799998},{"lat":26.02272603039999,"lng":119.29317294799998},{"lat":26.02239603039999,"lng":119.29371294799998},{"lat":26.022177030399988,"lng":119.29411194799998},{"lat":26.022038030399987,"lng":119.29440194799999},{"lat":26.021978030399985,"lng":119.29467094799999},{"lat":26.021759030399984,"lng":119.29520094799999},{"lat":26.021569030399984,"lng":119.29584094799999},{"lat":26.021510030399984,"lng":119.29609094799999},{"lat":26.021420030399984,"lng":119.29665994799998},{"lat":26.021381030399983,"lng":119.29742994799999},{"lat":26.021420030399984,"lng":119.30099894799999},{"lat":26.021430030399983,"lng":119.30281794799998},{"lat":26.021420030399984,"lng":119.30321694799999},{"lat":26.021361030399984,"lng":119.30383694799998},{"lat":26.021171030399984,"lng":119.30477594799999},{"lat":26.020761030399985,"lng":119.30652594799999},{"lat":26.020462030399987,"lng":119.30792594799999},{"lat":26.020272030399987,"lng":119.30907894799999},{"lat":26.02016303039999,"lng":119.31001494799999},{"lat":26.02015303039999,"lng":119.31010494799999},{"lat":26.02011303039999,"lng":119.31050394799999},{"lat":26.02005403039999,"lng":119.311363948},{"lat":26.02003403039999,"lng":119.31192394799999},{"lat":26.02003403039999,"lng":119.31233294799999},{"lat":26.02007403039999,"lng":119.31442294799999},{"lat":26.02016403039999,"lng":119.31729194799999},{"lat":26.02020303039999,"lng":119.31876194799999},{"lat":26.02015403039999,"lng":119.32071194799998},{"lat":26.01991503039999,"lng":119.32346094799998},{"lat":26.01988503039999,"lng":119.32401094799998},{"lat":26.01986503039999,"lng":119.32482994799999},{"lat":26.019856030399993,"lng":119.325609948},{"lat":26.019933030399994,"lng":119.327301948},{"lat":26.019935030399992,"lng":119.327960948},{"lat":26.02001703039999,"lng":119.328754948},{"lat":26.02015503039999,"lng":119.330767948},{"lat":26.02029003039999,"lng":119.33330994800001},{"lat":26.020554030399992,"lng":119.337476948},{"lat":26.020633030399992,"lng":119.33798694800001},{"lat":26.020692030399992,"lng":119.33824594800001},{"lat":26.02082203039999,"lng":119.338675948},{"lat":26.021051030399992,"lng":119.339295948},{"lat":26.02132003039999,"lng":119.339904948},{"lat":26.02159003039999,"lng":119.340343948},{"lat":26.02181303039999,"lng":119.340668948},{"lat":26.02246903039999,"lng":119.341542948},{"lat":26.02452803039999,"lng":119.34434294799999},{"lat":26.02459803039999,"lng":119.34445194799999},{"lat":26.02492703039999,"lng":119.34487194799999},{"lat":26.02528603039999,"lng":119.34526094799999},{"lat":26.02590603039999,"lng":119.34587094799998},{"lat":26.02626603039999,"lng":119.34618094799998},{"lat":26.02881503039999,"lng":119.34821994799998},{"lat":26.02924403039999,"lng":119.34854894799997},{"lat":26.03369403039999,"lng":119.35208794799998},{"lat":26.03457303039999,"lng":119.35278794799997},{"lat":26.03463303039999,"lng":119.35285694799997},{"lat":26.03604203039999,"lng":119.35398594799997},{"lat":26.03732203039999,"lng":119.35498594799998},{"lat":26.03834103039999,"lng":119.35572594799997},{"lat":26.03861003039999,"lng":119.35593494799997},{"lat":26.04015003039999,"lng":119.35700494799997},{"lat":26.040460030399988,"lng":119.35723394799997},{"lat":26.044479030399987,"lng":119.36002294799998},{"lat":26.045349030399986,"lng":119.36060294799998},{"lat":26.046228030399988,"lng":119.36116294799997},{"lat":26.04869703039999,"lng":119.36262194799997},{"lat":26.049587030399987,"lng":119.36316094799997},{"lat":26.049587030399987,"lng":119.36316094799997},{"lat":26.04979603039999,"lng":119.36344094799998},{"lat":26.04990603039999,"lng":119.36361094799997},{"lat":26.049995030399987,"lng":119.36380994799997},{"lat":26.050105030399987,"lng":119.36421894799997},{"lat":26.050135030399986,"lng":119.36447894799997},{"lat":26.050135030399986,"lng":119.36471794799996},{"lat":26.050066030399986,"lng":119.36509694799996},{"lat":26.050016030399984,"lng":119.36524694799996},{"lat":26.049876030399986,"lng":119.36548694799997},{"lat":26.049697030399987,"lng":119.36571594799997},{"lat":26.049508030399988,"lng":119.36589594799997},{"lat":26.04920903039999,"lng":119.36609494799997},{"lat":26.04883903039999,"lng":119.36629494799998},{"lat":26.048599030399988,"lng":119.36641494799997},{"lat":26.048090030399987,"lng":119.36661394799997},{"lat":26.047960030399988,"lng":119.36669394799996},{"lat":26.047811030399988,"lng":119.36675394799997},{"lat":26.046562030399986,"lng":119.36737294799997},{"lat":26.045853030399986,"lng":119.36781194799997},{"lat":26.045583030399985,"lng":119.36800094799997},{"lat":26.044984030399984,"lng":119.36846094799998},{"lat":26.044615030399985,"lng":119.36877094799998},{"lat":26.041595030399986,"lng":119.37158094799997},{"lat":26.040256030399984,"lng":119.37289094799998},{"lat":26.040256030399984,"lng":119.37289094799998},{"lat":26.039027030399986,"lng":119.37406994799997},{"lat":26.038107030399985,"lng":119.37492994799997},{"lat":26.036317030399985,"lng":119.37667994799997},{"lat":26.035028030399985,"lng":119.37774894799998},{"lat":26.033879030399984,"lng":119.37857794799997},{"lat":26.033879030399984,"lng":119.37857794799997},{"lat":26.033340030399984,"lng":119.37893794799997},{"lat":26.032150030399983,"lng":119.37965694799998},{"lat":26.031211030399984,"lng":119.38024694799998},{"lat":26.030692030399983,"lng":119.38065594799998},{"lat":26.030692030399983,"lng":119.38065594799998},{"lat":26.030512030399983,"lng":119.38074594799998},{"lat":26.030122030399983,"lng":119.38102594799999},{"lat":26.029932030399983,"lng":119.38114594799998},{"lat":26.029482030399983,"lng":119.38129494799998},{"lat":26.02917303039998,"lng":119.38138494799998},{"lat":26.02908303039998,"lng":119.38139494799998},{"lat":26.02908303039998,"lng":119.38139494799998},{"lat":26.02868403039998,"lng":119.38129494799998},{"lat":26.02826403039998,"lng":119.38111594799997},{"lat":26.02794503039998,"lng":119.38103094799997},{"lat":26.02787303039998,"lng":119.38102394799998},{"lat":26.027795030399982,"lng":119.38103694799997},{"lat":26.02746603039998,"lng":119.38114694799998},{"lat":26.027256030399982,"lng":119.38131594799998},{"lat":26.027107030399982,"lng":119.38156594799997},{"lat":26.02705803039998,"lng":119.38187594799997},{"lat":26.02711703039998,"lng":119.38231494799997},{"lat":26.027446030399982,"lng":119.38307394799997},{"lat":26.02751003039998,"lng":119.38340294799997},{"lat":26.02754503039998,"lng":119.38375294799997},{"lat":26.027405030399983,"lng":119.38559294799997},{"lat":26.027346030399983,"lng":119.38599294799997},{"lat":26.027287030399982,"lng":119.38619194799996},{"lat":26.02705803039998,"lng":119.38658094799996},{"lat":26.02687803039998,"lng":119.38672094799996},{"lat":26.02676803039998,"lng":119.38678094799997},{"lat":26.02658803039998,"lng":119.38684094799997},{"lat":26.02642903039998,"lng":119.38687094799997},{"lat":26.02611003039998,"lng":119.38686094799996},{"lat":26.02596003039998,"lng":119.38681194799996},{"lat":26.023743030399977,"lng":119.38566494799996},{"lat":26.023743030399977,"lng":119.38566494799996},{"lat":26.022981030399976,"lng":119.38527294799995},{"lat":26.022981030399976,"lng":119.38527294799995},{"lat":26.022932030399975,"lng":119.38533194799994},{"lat":26.022927030399973,"lng":119.38541094799994},{"lat":26.022217030399972,"lng":119.38652194799994},{"lat":26.021914030399973,"lng":119.38692294799993},{"lat":26.021835030399973,"lng":119.38695994799994},{"lat":26.021835030399973,"lng":119.38695994799994},{"lat":26.022492030399974,"lng":119.38599894799994},{"lat":26.022492030399974,"lng":119.38599894799994},{"lat":26.022934030399973,"lng":119.38532994799994},{"lat":26.022934030399973,"lng":119.38532994799994},{"lat":26.022929030399972,"lng":119.38540894799993},{"lat":26.02221903039997,"lng":119.38651994799993},{"lat":26.02221903039997,"lng":119.38651994799993},{"lat":26.022929030399972,"lng":119.38540894799993},{"lat":26.022934030399973,"lng":119.38532994799994},{"lat":26.022934030399973,"lng":119.38532994799994},{"lat":26.022844030399973,"lng":119.38523094799993},{"lat":26.022215030399973,"lng":119.38613994799992},{"lat":26.019792030399973,"lng":119.38971394799992},{"lat":26.019792030399973,"lng":119.38971394799992},{"lat":26.018876030399973,"lng":119.39107894799993},{"lat":26.017576030399972,"lng":119.39348894799993},{"lat":26.017237030399972,"lng":119.39414794799993},{"lat":26.01689703039997,"lng":119.39479794799992},{"lat":26.01663703039997,"lng":119.39534794799992},{"lat":26.01637803039997,"lng":119.39599694799992},{"lat":26.01619803039997,"lng":119.39651694799991},{"lat":26.01605903039997,"lng":119.39697694799992},{"lat":26.015850030399967,"lng":119.39799594799992},{"lat":26.015790030399966,"lng":119.39839594799992},{"lat":26.015701030399967,"lng":119.39902494799992},{"lat":26.015658030399965,"lng":119.39970094799992},{"lat":26.015542030399967,"lng":119.40233394799992},{"lat":26.015462030399966,"lng":119.40371294799992},{"lat":26.015323030399966,"lng":119.40561294799993},{"lat":26.014953030399965,"lng":119.40862194799993},{"lat":26.014604030399965,"lng":119.41132094799994},{"lat":26.014494030399966,"lng":119.41215094799993},{"lat":26.014285030399964,"lng":119.41352994799993},{"lat":26.014216030399965,"lng":119.41388894799994},{"lat":26.014097030399963,"lng":119.41436894799993},{"lat":26.014027030399962,"lng":119.41456794799993},{"lat":26.013938030399963,"lng":119.41489694799992},{"lat":26.013708030399965,"lng":119.41549694799993},{"lat":26.012929030399963,"lng":119.41763794799992},{"lat":26.012549030399963,"lng":119.41872594799992},{"lat":26.012050030399962,"lng":119.41999494799991},{"lat":26.01188003039996,"lng":119.42036494799991},{"lat":26.011601030399962,"lng":119.42091494799992},{"lat":26.011232030399963,"lng":119.42153494799992},{"lat":26.009522030399964,"lng":119.42406394799991},{"lat":26.009072030399963,"lng":119.42470394799992},{"lat":26.008192030399965,"lng":119.42600294799992},{"lat":26.007839030399964,"lng":119.42649494799991},{"lat":26.007503030399963,"lng":119.42702194799992},{"lat":26.006754030399964,"lng":119.42813094799992},{"lat":26.005395030399963,"lng":119.43010094799992},{"lat":26.005125030399963,"lng":119.43051094799992},{"lat":26.004286030399964,"lng":119.43170994799992},{"lat":26.002117030399965,"lng":119.43440894799993},{"lat":26.001368030399966,"lng":119.43529894799993},{"lat":26.000508030399967,"lng":119.43629894799993},{"lat":25.99952803039997,"lng":119.43733394799993},{"lat":25.99952803039997,"lng":119.43733394799993},{"lat":25.99973603039997,"lng":119.43753794799993},{"lat":25.99994103039997,"lng":119.43781494799993},{"lat":26.00028303039997,"lng":119.43821994799993},{"lat":26.000765030399972,"lng":119.43874494799992},{"lat":26.001087030399972,"lng":119.43902194799992},{"lat":26.001167030399973,"lng":119.43907394799992},{"lat":26.001227030399974,"lng":119.43910294799991},{"lat":26.001372030399974,"lng":119.43911494799991},{"lat":26.001372030399974,"lng":119.43911494799991},{"lat":26.001144030399974,"lng":119.43929394799991},{"lat":26.001055030399975,"lng":119.43939794799991},{"lat":26.001055030399975,"lng":119.43939794799991},{"lat":26.000838030399976,"lng":119.43967294799991},{"lat":26.000977030399977,"lng":119.43979194799991},{"lat":26.001157030399977,"lng":119.43998094799991},{"lat":26.001415030399976,"lng":119.44008794799991},{"lat":26.001771030399976,"lng":119.44052494799992},{"lat":26.001890030399977,"lng":119.44081294799992},{"lat":26.001907030399977,"lng":119.44100694799991},{"lat":26.001812030399975,"lng":119.4414979479999},{"lat":26.001710030399977,"lng":119.44173894799991},{"lat":26.001618030399978,"lng":119.44191094799992},{"lat":26.001334030399978,"lng":119.44224894799991},{"lat":26.00087203039998,"lng":119.44288294799992},{"lat":26.000702030399978,"lng":119.44316594799992},{"lat":26.00027503039998,"lng":119.44398994799991},{"lat":26.00005803039998,"lng":119.44448494799991},{"lat":25.999797030399982,"lng":119.4449769479999},{"lat":25.999635030399983,"lng":119.4451819479999},{"lat":25.99936103039998,"lng":119.4454089479999},{"lat":25.99890403039998,"lng":119.4455999479999},{"lat":25.99890403039998,"lng":119.4455999479999},{"lat":25.998919030399982,"lng":119.44593294799989},{"lat":25.998899030399983,"lng":119.44614294799989},{"lat":25.998809030399983,"lng":119.44659994799989},{"lat":25.99879403039998,"lng":119.44673794799989},{"lat":25.998806030399983,"lng":119.44703894799989},{"lat":25.998837030399983,"lng":119.44713994799989},{"lat":25.998909030399982,"lng":119.44728994799989},{"lat":25.999152030399983,"lng":119.44771894799989},{"lat":25.999627030399985,"lng":119.44844394799989},{"lat":25.999917030399985,"lng":119.4488189479999},{"lat":25.999956030399986,"lng":119.44893894799989},{"lat":25.999956030399986,"lng":119.44946894799989},{"lat":25.999981030399987,"lng":119.44962894799988},{"lat":26.000005030399986,"lng":119.44967494799988},{"lat":26.000404030399988,"lng":119.44987794799988},{"lat":26.000573030399988,"lng":119.45002794799989},{"lat":26.000651030399986,"lng":119.45013394799989},{"lat":26.000730030399986,"lng":119.45025394799988},{"lat":26.001417030399985,"lng":119.45167594799989},{"lat":26.001549030399985,"lng":119.45186794799989},{"lat":26.001623030399987,"lng":119.45193794799988},{"lat":26.001732030399985,"lng":119.45200794799987},{"lat":26.001883030399984,"lng":119.45207694799987},{"lat":26.002524030399986,"lng":119.45229394799988},{"lat":26.002524030399986,"lng":119.45229394799988},{"lat":26.002505030399984,"lng":119.45225494799988}],
[{"lat":26.0024541207,"lng":119.4523812968},{"lat":26.002473120700003,"lng":119.4524202968},{"lat":26.002473120700003,"lng":119.4524202968},{"lat":26.0018321207,"lng":119.4522032968},{"lat":26.001681120700002,"lng":119.4521342968},{"lat":26.001572120700004,"lng":119.4520642968},{"lat":26.001498120700003,"lng":119.45199429680001},{"lat":26.001366120700002,"lng":119.45180229680001},{"lat":26.000679120700003,"lng":119.4503802968},{"lat":26.000600120700003,"lng":119.45026029680001},{"lat":26.000522120700005,"lng":119.45015429680001},{"lat":26.000393120700004,"lng":119.45003429680001},{"lat":26.000004120700005,"lng":119.44983529680002},{"lat":25.999955120700005,"lng":119.44980229680002},{"lat":25.999931120700005,"lng":119.44975629680002},{"lat":25.999931120700005,"lng":119.44975629680002},{"lat":25.999906120700004,"lng":119.44959629680002},{"lat":25.999906120700004,"lng":119.44906629680003},{"lat":25.999867120700003,"lng":119.44894629680003},{"lat":25.999577120700003,"lng":119.44857129680003},{"lat":25.9991021207,"lng":119.44784629680002},{"lat":25.9988591207,"lng":119.44741729680003},{"lat":25.9987871207,"lng":119.44726729680002},{"lat":25.9987561207,"lng":119.44716629680002},{"lat":25.9987441207,"lng":119.44686529680003},{"lat":25.9987591207,"lng":119.44672729680002},{"lat":25.9988491207,"lng":119.44627029680002},{"lat":25.9988691207,"lng":119.44606029680003},{"lat":25.9988691207,"lng":119.44606029680003},{"lat":25.9990881207,"lng":119.44577129680003},{"lat":25.999310120700002,"lng":119.44553629680003},{"lat":25.999584120700003,"lng":119.44530929680003},{"lat":25.999746120700003,"lng":119.44510429680004},{"lat":26.0000071207,"lng":119.44461229680005},{"lat":26.0002241207,"lng":119.44411729680004},{"lat":26.0006511207,"lng":119.44329329680005},{"lat":26.0008211207,"lng":119.44301029680005},{"lat":26.0012831207,"lng":119.44237629680005},{"lat":26.0015671207,"lng":119.44203829680005},{"lat":26.001659120699998,"lng":119.44186629680004},{"lat":26.001761120699996,"lng":119.44162529680004},{"lat":26.001856120699998,"lng":119.44113429680004},{"lat":26.001839120699998,"lng":119.44094029680005},{"lat":26.001720120699996,"lng":119.44065229680005},{"lat":26.001364120699996,"lng":119.44021529680005},{"lat":26.001346120699996,"lng":119.43987729680005},{"lat":26.001079120699995,"lng":119.43959429680005},{"lat":26.001079120699995,"lng":119.43959429680005},{"lat":26.001261120699994,"lng":119.43941029680005},{"lat":26.002836120699993,"lng":119.43799929680004},{"lat":26.00303512069999,"lng":119.43783629680004},{"lat":26.003095120699992,"lng":119.43776129680005},{"lat":26.003385120699992,"lng":119.43747229680005},{"lat":26.003855120699992,"lng":119.43692229680005},{"lat":26.00526412069999,"lng":119.43534329680004},{"lat":26.00561312069999,"lng":119.43490429680004},{"lat":26.00561312069999,"lng":119.43490429680004},{"lat":26.006862120699992,"lng":119.43635329680004},{"lat":26.006942120699993,"lng":119.43638329680003},{"lat":26.00722112069999,"lng":119.43685229680003},{"lat":26.00722112069999,"lng":119.43685229680003},{"lat":26.00661812069999,"lng":119.43748329680002},{"lat":26.00661812069999,"lng":119.43748329680002},{"lat":26.00639912069999,"lng":119.43753929680003},{"lat":26.00446812069999,"lng":119.43937729680003},{"lat":26.00429912069999,"lng":119.43951829680003},{"lat":26.00418312069999,"lng":119.43957829680004},{"lat":26.004059120699992,"lng":119.43959829680004},{"lat":26.003614120699993,"lng":119.43959029680005},{"lat":26.002762120699995,"lng":119.43944629680004},{"lat":26.002194120699993,"lng":119.43949129680004},{"lat":26.001800120699993,"lng":119.43955129680005},{"lat":26.001143120699993,"lng":119.43937729680005},{"lat":26.000873120699993,"lng":119.43925829680005},{"lat":26.000604120699993,"lng":119.43906429680005},{"lat":26.00000812069999,"lng":119.43840129680005},{"lat":25.999663120699992,"lng":119.43794329680006},{"lat":25.999401120699993,"lng":119.43753829680006},{"lat":25.999131120699992,"lng":119.43719329680006},{"lat":25.992388120699992,"lng":119.42672029680006},{"lat":25.991306120699992,"lng":119.42475029680006},{"lat":25.991306120699992,"lng":119.42475029680006},{"lat":25.991206120699992,"lng":119.42410329680006},{"lat":25.990740120699993,"lng":119.42313229680005},{"lat":25.990000120699992,"lng":119.42091129680004},{"lat":25.98994712069999,"lng":119.42085529680004},{"lat":25.989879120699992,"lng":119.42083229680004},{"lat":25.989800120699993,"lng":119.42083229680004},{"lat":25.989721120699993,"lng":119.42084329680004},{"lat":25.989581120699995,"lng":119.42091729680004},{"lat":25.989581120699995,"lng":119.42091729680004},{"lat":25.989543120699995,"lng":119.42097429680004},{"lat":25.989546120699995,"lng":119.42105429680004},{"lat":25.990105120699994,"lng":119.42259829680003},{"lat":25.990427120699994,"lng":119.42339529680004},{"lat":25.990926120699996,"lng":119.42447529680004},{"lat":25.991164120699995,"lng":119.42479129680004},{"lat":25.992224120699994,"lng":119.42675529680004},{"lat":25.995870120699994,"lng":119.43258429680004},{"lat":25.995870120699994,"lng":119.43258429680004},{"lat":25.998853120699994,"lng":119.43735429680004},{"lat":25.998975120699996,"lng":119.43751829680004},{"lat":25.998975120699996,"lng":119.43751829680004},{"lat":25.999015120699994,"lng":119.43768629680004},{"lat":25.999239120699993,"lng":119.43802029680003},{"lat":26.000009120699993,"lng":119.43900029680003},{"lat":26.000354120699992,"lng":119.43941629680003},{"lat":26.000354120699992,"lng":119.43941629680003},{"lat":26.00068512069999,"lng":119.43989929680004},{"lat":26.000973120699992,"lng":119.44049729680003},{"lat":26.001206120699994,"lng":119.44115729680003},{"lat":26.001551120699993,"lng":119.44197629680004},{"lat":26.001582120699993,"lng":119.44201729680003},{"lat":26.001645120699994,"lng":119.44208529680003},{"lat":26.001947120699995,"lng":119.44232329680003},{"lat":26.002105120699994,"lng":119.44238429680003},{"lat":26.002313120699995,"lng":119.44244829680002},{"lat":26.002599120699994,"lng":119.44245329680002},{"lat":26.002684120699993,"lng":119.44242929680003},{"lat":26.002684120699993,"lng":119.44242929680003},{"lat":26.003181120699992,"lng":119.44217629680003},{"lat":26.00335612069999,"lng":119.44203329680003},{"lat":26.00347112069999,"lng":119.44187129680003},{"lat":26.00365412069999,"lng":119.44145329680003},{"lat":26.00365412069999,"lng":119.44145329680003},{"lat":26.003711120699993,"lng":119.44102629680003},{"lat":26.003707120699993,"lng":119.44080829680003},{"lat":26.00365712069999,"lng":119.44057129680003},{"lat":26.003627120699992,"lng":119.44048329680002},{"lat":26.003541120699992,"lng":119.44031129680002},{"lat":26.003431120699993,"lng":119.44012529680002},{"lat":26.003185120699992,"lng":119.43989729680001},{"lat":26.002908120699992,"lng":119.43976329680001},{"lat":26.002511120699992,"lng":119.43969429680001},{"lat":26.00210912069999,"lng":119.43968629680002},{"lat":26.00186212069999,"lng":119.43965929680002},{"lat":26.00164512069999,"lng":119.43961629680001},{"lat":26.00140212069999,"lng":119.43954729680001},{"lat":26.00109412069999,"lng":119.43942229680002},{"lat":26.00060312069999,"lng":119.43906829680002},{"lat":26.000007120699987,"lng":119.43840529680001},{"lat":25.999662120699988,"lng":119.43794729680002},{"lat":25.99940012069999,"lng":119.43754229680002},{"lat":25.999130120699988,"lng":119.43719729680002},{"lat":25.992387120699988,"lng":119.42672429680002},{"lat":25.991305120699987,"lng":119.42475429680002},{"lat":25.991011120699987,"lng":119.42415729680002},{"lat":25.990581120699986,"lng":119.42314629680001},{"lat":25.989988120699987,"lng":119.42148329680002},{"lat":25.989798120699987,"lng":119.42083629680002},{"lat":25.989683120699986,"lng":119.42038029680002},{"lat":25.988834120699988,"lng":119.41777229680002},{"lat":25.988405120699987,"lng":119.41626029680002},{"lat":25.987225120699986,"lng":119.41252629680002},{"lat":25.986115120699985,"lng":119.40857629680002},{"lat":25.985228120699986,"lng":119.40573129680003},{"lat":25.984674120699985,"lng":119.40403129680003},{"lat":25.982693120699984,"lng":119.39730629680002},{"lat":25.982585120699984,"lng":119.39689029680002},{"lat":25.982341120699985,"lng":119.39575929680002},{"lat":25.982145120699986,"lng":119.39431329680002},{"lat":25.981963120699987,"lng":119.39280529680002},{"lat":25.981617120699987,"lng":119.39028029680001},{"lat":25.981617120699987,"lng":119.39028029680001},{"lat":25.981602120699986,"lng":119.38941129680002},{"lat":25.981602120699986,"lng":119.38941129680002},{"lat":25.981767120699985,"lng":119.39069529680002},{"lat":25.981924120699986,"lng":119.39211429680002},{"lat":25.982073120699987,"lng":119.39316129680002},{"lat":25.982118120699987,"lng":119.39338229680001},{"lat":25.982118120699987,"lng":119.39338229680001},{"lat":25.982073120699987,"lng":119.39316129680002},{"lat":25.981924120699986,"lng":119.39211429680002},{"lat":25.981767120699985,"lng":119.39069529680002},{"lat":25.981602120699986,"lng":119.38941129680002},{"lat":25.981428120699984,"lng":119.38806629680002},{"lat":25.981286120699984,"lng":119.38666429680002},{"lat":25.981099120699984,"lng":119.38537729680002},{"lat":25.981020120699984,"lng":119.38451529680002},{"lat":25.981020120699984,"lng":119.38451529680002},{"lat":25.980733120699984,"lng":119.38363629680002},{"lat":25.980351120699986,"lng":119.38083829680002},{"lat":25.980259120699987,"lng":119.37990829680002},{"lat":25.980242120699987,"lng":119.37932929680002},{"lat":25.980242120699987,"lng":119.37823929680002},{"lat":25.980266120699987,"lng":119.37747229680002},{"lat":25.980476120699986,"lng":119.37474429680002},{"lat":25.980645120699986,"lng":119.37307829680002},{"lat":25.980699120699985,"lng":119.36926729680002},{"lat":25.980722120699983,"lng":119.36315129680001},{"lat":25.980808120699983,"lng":119.35873329680001},{"lat":25.981044120699984,"lng":119.35774729680001},{"lat":25.983223120699986,"lng":119.35015029680001},{"lat":25.983415120699984,"lng":119.3491552968},{"lat":25.983464120699985,"lng":119.3485772968},{"lat":25.983464120699985,"lng":119.3485772968},{"lat":25.983507120699986,"lng":119.3481532968},{"lat":25.983606120699985,"lng":119.34755429680001},{"lat":25.983706120699985,"lng":119.34723429680001},{"lat":25.983895120699984,"lng":119.34681529680002},{"lat":25.984014120699985,"lng":119.34660529680002},{"lat":25.984364120699986,"lng":119.34615629680002},{"lat":25.984513120699987,"lng":119.34600629680001},{"lat":25.984783120699987,"lng":119.34579629680002},{"lat":25.984882120699986,"lng":119.34573629680001},{"lat":25.985182120699985,"lng":119.34557729680002},{"lat":25.985361120699984,"lng":119.34549829680002},{"lat":25.985680120699985,"lng":119.34542929680002},{"lat":25.988270120699987,"lng":119.34462929680002},{"lat":25.990530120699987,"lng":119.34376929680002},{"lat":25.991719120699987,"lng":119.34336029680001},{"lat":25.992649120699987,"lng":119.34311029680002},{"lat":25.992649120699987,"lng":119.34311029680002},{"lat":25.993569120699988,"lng":119.34279129680002},{"lat":25.993569120699988,"lng":119.34279129680002},{"lat":25.99438612069999,"lng":119.34246129680001},{"lat":25.99455812069999,"lng":119.3424122968},{"lat":25.99505712069999,"lng":119.34221329680001},{"lat":25.99538612069999,"lng":119.34199429680001},{"lat":25.99548612069999,"lng":119.3418842968},{"lat":25.99560512069999,"lng":119.3417042968},{"lat":25.99571412069999,"lng":119.3413942968},{"lat":25.99573412069999,"lng":119.3411252968},{"lat":25.99572412069999,"lng":119.3409062968},{"lat":25.99568512069999,"lng":119.3407472968},{"lat":25.995556120699987,"lng":119.34044729680001},{"lat":25.995386120699987,"lng":119.34019729680001},{"lat":25.995217120699987,"lng":119.34004729680001},{"lat":25.99480712069999,"lng":119.3397782968},{"lat":25.994657120699987,"lng":119.33965829680001},{"lat":25.99436812069999,"lng":119.33940829680002},{"lat":25.99416812069999,"lng":119.33919829680002},{"lat":25.993928120699987,"lng":119.33891829680002},{"lat":25.993579120699987,"lng":119.33839929680002},{"lat":25.99320012069999,"lng":119.33771929680002},{"lat":25.99187012069999,"lng":119.33308929680001},{"lat":25.99103112069999,"lng":119.33020029680002},{"lat":25.99082112069999,"lng":119.32952029680001},{"lat":25.99031212069999,"lng":119.32773129680001},{"lat":25.99019512069999,"lng":119.32725329680001},{"lat":25.98996312069999,"lng":119.32617229680001},{"lat":25.98973312069999,"lng":119.32458229680002},{"lat":25.989554120699992,"lng":119.32318229680001},{"lat":25.988738120699992,"lng":119.31593129680002},{"lat":25.988345120699993,"lng":119.31264329680002},{"lat":25.98766612069999,"lng":119.30669329680002},{"lat":25.987446120699992,"lng":119.30495429680002},{"lat":25.987347120699994,"lng":119.30401529680002},{"lat":25.987267120699993,"lng":119.30316629680001},{"lat":25.987218120699993,"lng":119.30225729680002},{"lat":25.987208120699993,"lng":119.30135729680002},{"lat":25.987267120699993,"lng":119.30020729680002},{"lat":25.987386120699995,"lng":119.29895729680003},{"lat":25.987456120699996,"lng":119.29836729680002},{"lat":25.987596120699994,"lng":119.29758729680002},{"lat":25.987786120699994,"lng":119.29667829680002},{"lat":25.987976120699994,"lng":119.29585929680002},{"lat":25.988135120699994,"lng":119.29532029680001},{"lat":25.988425120699993,"lng":119.29447129680001},{"lat":25.988864120699994,"lng":119.2933312968},{"lat":25.989143120699993,"lng":119.2927122968},{"lat":25.989943120699994,"lng":119.2911022968},{"lat":25.991142120699994,"lng":119.28923229680001},{"lat":25.991752120699996,"lng":119.2884522968},{"lat":25.994861120699994,"lng":119.2846632968},{"lat":25.995751120699992,"lng":119.28347429680001},{"lat":25.997140120699992,"lng":119.28138529680001},{"lat":25.998679120699993,"lng":119.2790352968},{"lat":25.998679120699993,"lng":119.2790352968},{"lat":25.999018120699994,"lng":119.2785962968},{"lat":25.999278120699994,"lng":119.27834629680001},{"lat":25.999477120699993,"lng":119.27819729680002},{"lat":25.999846120699992,"lng":119.27800829680001},{"lat":26.000255120699993,"lng":119.27783829680001},{"lat":26.000698120699994,"lng":119.27773129680001},{"lat":26.000994120699993,"lng":119.27768929680002},{"lat":26.00158412069999,"lng":119.27776929680002},{"lat":26.00185312069999,"lng":119.27781829680002},{"lat":26.00211212069999,"lng":119.27788829680001},{"lat":26.002241120699992,"lng":119.27793729680002},{"lat":26.00247112069999,"lng":119.27806629680002},{"lat":26.00292112069999,"lng":119.27835629680003},{"lat":26.00326012069999,"lng":119.27861529680003},{"lat":26.00387912069999,"lng":119.27917529680002},{"lat":26.00404412069999,"lng":119.27930029680002},{"lat":26.00404412069999,"lng":119.27930029680002},{"lat":26.00443812069999,"lng":119.27955429680001},{"lat":26.005583120699992,"lng":119.28017129680002},{"lat":26.005649120699992,"lng":119.28020029680002},{"lat":26.005915120699992,"lng":119.28026229680002},{"lat":26.00651512069999,"lng":119.28070829680001},{"lat":26.006796120699992,"lng":119.28093929680001},{"lat":26.007965120699993,"lng":119.28181129680002},{"lat":26.008744120699994,"lng":119.28241029680001},{"lat":26.009354120699996,"lng":119.28290029680001},{"lat":26.009974120699997,"lng":119.2833692968},{"lat":26.011083120699997,"lng":119.2842992968},{"lat":26.011463120699997,"lng":119.2845792968},{"lat":26.0131721207,"lng":119.2859382968},{"lat":26.0146521207,"lng":119.2868982968},{"lat":26.0187261207,"lng":119.28925429680001},{"lat":26.0219611207,"lng":119.29119729680001},{"lat":26.0219611207,"lng":119.29119729680001},{"lat":26.0222511207,"lng":119.29146729680001},{"lat":26.0223901207,"lng":119.29161729680001},{"lat":26.0226501207,"lng":119.29199629680001},{"lat":26.0228201207,"lng":119.2923252968},{"lat":26.0230591207,"lng":119.2929052968},{"lat":26.0231681207,"lng":119.2930942968},{"lat":26.0232781207,"lng":119.29323329680001},{"lat":26.0233681207,"lng":119.29331329680001},{"lat":26.0235271207,"lng":119.29340329680001},{"lat":26.0237071207,"lng":119.2934722968},{"lat":26.0237971207,"lng":119.29349229680001},{"lat":26.0238871207,"lng":119.29349229680001},{"lat":26.0241061207,"lng":119.29346229680002},{"lat":26.0243351207,"lng":119.29335229680001},{"lat":26.024494120700002,"lng":119.29322329680001},{"lat":26.0247141207,"lng":119.29296429680001},{"lat":26.0251831207,"lng":119.29229429680001},{"lat":26.0254431207,"lng":119.29204429680001},{"lat":26.0255331207,"lng":119.29197529680002},{"lat":26.0257331207,"lng":119.29185529680002},{"lat":26.0268421207,"lng":119.29140629680002},{"lat":26.027262120699998,"lng":119.29117729680002},{"lat":26.0289111207,"lng":119.29059729680002},{"lat":26.030071120699997,"lng":119.29020829680002},{"lat":26.030519120699996,"lng":119.29001229680001},{"lat":26.030890120699997,"lng":119.28986929680002},{"lat":26.031520120699998,"lng":119.28958029680003},{"lat":26.0324091207,"lng":119.28912029680002},{"lat":26.0332881207,"lng":119.28859029680002},{"lat":26.0338481207,"lng":119.28822029680002},{"lat":26.0338481207,"lng":119.28822029680002},{"lat":26.034337120700002,"lng":119.28806129680002},{"lat":26.034857120700003,"lng":119.28771229680002},{"lat":26.034857120700003,"lng":119.28771229680002},{"lat":26.035126120700003,"lng":119.28760229680002},{"lat":26.035485120700002,"lng":119.28753329680002},{"lat":26.0356951207,"lng":119.28752429680002},{"lat":26.0361341207,"lng":119.28756329680002},{"lat":26.0373431207,"lng":119.28782229680002},{"lat":26.0373431207,"lng":119.28782229680002},{"lat":26.0374321207,"lng":119.28784229680002},{"lat":26.0375011207,"lng":119.28739329680002},{"lat":26.0376611207,"lng":119.28654329680002},{"lat":26.0378101207,"lng":119.28616429680002},{"lat":26.0379691207,"lng":119.28586529680003},{"lat":26.0380691207,"lng":119.28570629680003},{"lat":26.0384591207,"lng":119.28515629680003},{"lat":26.040009120700002,"lng":119.28305729680002},{"lat":26.0410481207,"lng":119.28154829680003},{"lat":26.0415481207,"lng":119.28087829680003},{"lat":26.0426171207,"lng":119.27983929680002},{"lat":26.0430661207,"lng":119.27935929680002},{"lat":26.0440341207,"lng":119.27859929680002},{"lat":26.044246120700002,"lng":119.27847129680002},{"lat":26.045055120700003,"lng":119.27783229680001},{"lat":26.0454441207,"lng":119.27755229680001},{"lat":26.0457891207,"lng":119.27726929680001},{"lat":26.0460271207,"lng":119.27704329680002},{"lat":26.0462291207,"lng":119.27693529680002},{"lat":26.048072120700002,"lng":119.27548429680002},{"lat":26.0482611207,"lng":119.27531429680002},{"lat":26.0488691207,"lng":119.27468429680002},{"lat":26.0488691207,"lng":119.27468429680002},{"lat":26.049250120700002,"lng":119.27427529680001},{"lat":26.049900120700002,"lng":119.2736362968},{"lat":26.049900120700002,"lng":119.2736362968},{"lat":26.0496401207,"lng":119.27320629680001},{"lat":26.0489961207,"lng":119.27224829680002},{"lat":26.048818120700002,"lng":119.27188829680001},{"lat":26.048805120700003,"lng":119.27162729680002},{"lat":26.047742120700004,"lng":119.26900329680002},{"lat":26.047590120700004,"lng":119.26853929680003},{"lat":26.047518120700005,"lng":119.26795529680003},{"lat":26.047503120700004,"lng":119.26726929680002},{"lat":26.047499120700003,"lng":119.26424929680002},{"lat":26.047474120700002,"lng":119.26234129680002},{"lat":26.0474831207,"lng":119.26177129680002},{"lat":26.0474721207,"lng":119.26013629680003},{"lat":26.0474731207,"lng":119.25993729680003},{"lat":26.0474631207,"lng":119.25849329680003},{"lat":26.047512120700002,"lng":119.25736329680002},{"lat":26.047522120700002,"lng":119.25584429680002},{"lat":26.0475111207,"lng":119.25526329680002},{"lat":26.0475241207,"lng":119.25476529680003},{"lat":26.0474431207,"lng":119.25198529680003},{"lat":26.0474261207,"lng":119.25014929680003},{"lat":26.047214120699998,"lng":119.24702629680003},{"lat":26.0471151207,"lng":119.24589729680002},{"lat":26.0471151207,"lng":119.24589729680002},{"lat":26.0470261207,"lng":119.24586729680003},{"lat":26.0469271207,"lng":119.24586729680003},{"lat":26.0462831207,"lng":119.24590429680003}]

];
	
	
	this.busjsondata={};
	this.httpsserver=https.createServer({key:`-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAlx/E5xXkhstE8geWkiNWFQcMExoyg6JRN718hvzCPz87Q0sO
UCa2AZ5qOLEzb6sWEHwYN19YMc4unVDKU27LxHelexkcycBmaELCvZPrPbVb8iiT
GQhGqL6QPunJeQJB0+XZWA/4TLgIkyYmlTgso5+cOlZ9+P0Hst02sqV/U1+YKu+h
mFD0RZuz+FU/pdYdZD39FU/Z7zcbhBcnQpQy7FTyXt81ykm4p3woRSU29jswkMIN
WIgFVetYgDlTJji/pQGOxWreKVflbCvsAHFhd2K00wXZwVQP/mAL0ajfIAetmiju
rkA7E4t2gQfsNkbv/3ohwbM33OeBGPYzGFUlZwIDAQABAoIBAC4HXhioQV+Q3+H7
z6+ZFan36ISU8RfIw4X/r8MJjzxmTO2VGbnt4HejwWSdDDaR3HmO4m1TG/CnhOkj
Z0x8LZIcgwl4P51vfYF5/Ahz2i2EZIngM9VnAOZ6jEKtQFEcD+KzWjyJOK5dSzdO
YmgGoQoBHjtihqHkp4ih+fv1jk9dECac41lDHgcTmoZKftkRuiTzGhGKChKaue/y
Sh0/vUD3hy2Bw7UP/TDSYDTskKSJ+zIJIQdAt2gsiAv03ZEWG3U2lVWCelj6Yc/a
XPNkv7uWPW5Fp9q4lvdZyHo0uhabA+95UmxoK0Kvhf7Y0AykCtbDXmoAVgU1PVgk
lg1fzYkCgYEA5V8f0amuGP35y42BO/uChJ1K1rau9RHs1KQ3xXgWY1gx5ABFDhAe
AX9s8Td//2U+pia/vBkGGSYoo0BJLD7xJvfEpC8pN2qVP+YIltKmNdsSieHnhcwj
Lt6aRwkWQ918pbjopHd3R+awQcMe89qAe2bIEJEM5Y9yKq5kthmY85UCgYEAqKsl
Xkz4j/gISD9C6Q8cZSxnwS9XX4pKDUgV8FWEND70vkBStE3rM9FoCmsd8cV1Ww0W
c6peZtViLyUsZatt9jslafa3O5ysyFqLJ1hthUDLU3mju2mL6lIGLZbv8XCSGm5w
N+CyJrvOfNoj7ZRlfgM0YTnmVLGhk6aaYuWMdgsCgYEAj9IOfIN9c5REfbqzju3M
T+TkmS8hEu9zZX22rq32s8IIPmNg6Ul31w6UO8fGDVjpaHshfArgxQIlNv/HIeQx
h3KSLTSZDnNZNCDDv/ZDW7+Kp0QrzLxMT0YqzGHJQTJuxubjkMSL2Vyvpfx3uwWF
zFqNFb4trP894b9JzNjOC+UCgYB0/rod7kAgBQkhrBfqd1vX5fRWMVNm5xK0ocLu
ATOB1gWIDjAP91hliiSjzWdo8/GSZcKkGpH+vJatYxinsUDGIoKyPLses2+6Tevm
L9VQMACZd2+WKQEvWRQF/YOUMuR1RxO5/rc0XOM/AUUYn+3CedCUfEgDiW8tbsv6
O4WxvwKBgQCFO2L3DFB983QQvm/PKFQmCook/VadeKEptodF9Xg78uTZ7b/zJ6s2
A0WPNPydUWzx2Vkkr7NdGRyS97Lo8RTeufk9sD6Y3uTKbywK99W6Tvl28x60/KYc
S/Xmia02MnAhtPreBSXLOYWUAu9zyb1TSAQz2jfaX9bW7cvgpcDAxg==
-----END RSA PRIVATE KEY-----
`,cert:`-----BEGIN CERTIFICATE-----
MIIFfjCCBGagAwIBAgIQDKiOKT2L3Pn3TBjII8Mt1zANBgkqhkiG9w0BAQsFADBu
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMS0wKwYDVQQDEyRFbmNyeXB0aW9uIEV2ZXJ5d2hlcmUg
RFYgVExTIENBIC0gRzEwHhcNMTkwMjAyMDAwMDAwWhcNMjAwMjAyMTIwMDAwWjAY
MRYwFAYDVQQDEw1hYnVzLnh5c2JzLmNuMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAlx/E5xXkhstE8geWkiNWFQcMExoyg6JRN718hvzCPz87Q0sOUCa2
AZ5qOLEzb6sWEHwYN19YMc4unVDKU27LxHelexkcycBmaELCvZPrPbVb8iiTGQhG
qL6QPunJeQJB0+XZWA/4TLgIkyYmlTgso5+cOlZ9+P0Hst02sqV/U1+YKu+hmFD0
RZuz+FU/pdYdZD39FU/Z7zcbhBcnQpQy7FTyXt81ykm4p3woRSU29jswkMINWIgF
VetYgDlTJji/pQGOxWreKVflbCvsAHFhd2K00wXZwVQP/mAL0ajfIAetmijurkA7
E4t2gQfsNkbv/3ohwbM33OeBGPYzGFUlZwIDAQABo4ICbDCCAmgwHwYDVR0jBBgw
FoAUVXRPsnJP9WC6UNHX5lFcmgGHGtcwHQYDVR0OBBYEFLK/is1hYOPm7jbYkD1s
Vimn57B/MBgGA1UdEQQRMA+CDWFidXMueHlzYnMuY24wDgYDVR0PAQH/BAQDAgWg
MB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjBMBgNVHSAERTBDMDcGCWCG
SAGG/WwBAjAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20v
Q1BTMAgGBmeBDAECATB9BggrBgEFBQcBAQRxMG8wIQYIKwYBBQUHMAGGFWh0dHA6
Ly9vY3NwLmRjb2NzcC5jbjBKBggrBgEFBQcwAoY+aHR0cDovL2NhY2VydHMuZGln
aWNlcnQuY29tL0VuY3J5cHRpb25FdmVyeXdoZXJlRFZUTFNDQS1HMS5jcnQwCQYD
VR0TBAIwADCCAQMGCisGAQQB1nkCBAIEgfQEgfEA7wB2AO5Lvbd1zmC64UJpH6vh
nmajD35fsHLYgwDEe4l6qP3LAAABaK6nDAcAAAQDAEcwRQIgRXSUgtO0KRVd/XXh
KiOswkfZTFEIAx1Mj/KmGfLusJUCIQCaMvloQ0ZHmfNhEKaiaJ2eClnwHNjuZcC3
imP2YSgufwB1AId1v+dZfPiMQ5lfvfNu/1aNR1Y2/0q1YMG06v9eoIMPAAABaK6n
DOQAAAQDAEYwRAIgX/VP1OeTYyelqvpgDiGw4aSASEGCUJsoOjXmQF1AyZMCIDp0
gDAChrmIRGTqo7Pit9caaxGUDb0HtBVWDMYaSeQ0MA0GCSqGSIb3DQEBCwUAA4IB
AQCfRrMk6wlQCgNu0pnoy4vJiotdS7mqSL3SFw9OUc0rpLSmFsRM2KDNnsH/62Tx
s7Q4u17GXDGCFJTG8vGTJmDfU5OcdywfZAQ1EpcHu4TrjmGV8jINO4AQmwyHMih4
NC3dFU73bIWJWxVhNGVBNFEDf7uz+KWKGPU93I772EImDmawInzfTtDQ5OKOZ+3i
NlC3wpvBzPeEfQtbjXeNZ5ozWovaSkt+f1R06fI8OThJ9jEhcilUcP/VXdlFI1X/
EHta7GG83J8k2IHfHYQfAvnQBwy0t5MgX9Czf95hoRb/oY0uN5m+vesroi05ow7Y
miU+SfLXmYXGTMWGZ0F4X2CE
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEqjCCA5KgAwIBAgIQAnmsRYvBskWr+YBTzSybsTANBgkqhkiG9w0BAQsFADBh
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBD
QTAeFw0xNzExMjcxMjQ2MTBaFw0yNzExMjcxMjQ2MTBaMG4xCzAJBgNVBAYTAlVT
MRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5j
b20xLTArBgNVBAMTJEVuY3J5cHRpb24gRXZlcnl3aGVyZSBEViBUTFMgQ0EgLSBH
MTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALPeP6wkab41dyQh6mKc
oHqt3jRIxW5MDvf9QyiOR7VfFwK656es0UFiIb74N9pRntzF1UgYzDGu3ppZVMdo
lbxhm6dWS9OK/lFehKNT0OYI9aqk6F+U7cA6jxSC+iDBPXwdF4rs3KRyp3aQn6pj
pp1yr7IB6Y4zv72Ee/PlZ/6rK6InC6WpK0nPVOYR7n9iDuPe1E4IxUMBH/T33+3h
yuH3dvfgiWUOUkjdpMbyxX+XNle5uEIiyBsi4IvbcTCh8ruifCIi5mDXkZrnMT8n
wfYCV6v6kDdXkbgGRLKsR4pucbJtbKqIkUGxuZI2t7pfewKRc5nWecvDBZf3+p1M
pA8CAwEAAaOCAU8wggFLMB0GA1UdDgQWBBRVdE+yck/1YLpQ0dfmUVyaAYca1zAf
BgNVHSMEGDAWgBQD3lA1VtFMu2bwo+IbG8OXsj3RVTAOBgNVHQ8BAf8EBAMCAYYw
HQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMBIGA1UdEwEB/wQIMAYBAf8C
AQAwNAYIKwYBBQUHAQEEKDAmMCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdp
Y2VydC5jb20wQgYDVR0fBDswOTA3oDWgM4YxaHR0cDovL2NybDMuZGlnaWNlcnQu
Y29tL0RpZ2lDZXJ0R2xvYmFsUm9vdENBLmNybDBMBgNVHSAERTBDMDcGCWCGSAGG
/WwBAjAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BT
MAgGBmeBDAECATANBgkqhkiG9w0BAQsFAAOCAQEAK3Gp6/aGq7aBZsxf/oQ+TD/B
SwW3AU4ETK+GQf2kFzYZkby5SFrHdPomunx2HBzViUchGoofGgg7gHW0W3MlQAXW
M0r5LUvStcr82QDWYNPaUy4taCQmyaJ+VB+6wxHstSigOlSNF2a6vg4rgexixeiV
4YSB03Yqp2t3TeZHM9ESfkus74nQyW7pRGezj+TC44xCagCQQOzzNmzEAP2SnCrJ
sNE2DpRVMnL8J6xBRdjmOsC3N6cQuKuRXbzByVBjCqAA8t1L0I+9wXJerLPyErjy
rMKWaBFLmfK/AHNF4ZihwPGOc7w6UHczBZXH5RFzJNnww+WnKuTPI0HfnVH8lg==	
-----END CERTIFICATE-----
`},(req,res)=>{

		res.writeHead(200, {'Content-Type': 'text/html;charset=utf-8'});

let path=url.parse(req.url).path;
let reqid=path.substring(1,path.length);


		if(reqid=='ALL')
		res.write(JSON.stringify(this.busjsondata));
		else if(reqid=='ALLINFO'){
		res.write(JSON.stringify({businfo:this.busjsondata,polyline:this.getPolyLine(),stopMarkers:this.getStopMarkers()}));

		}else
		{
		if(this.busjsondata[path.substring(1,path.length)])
		res.write(JSON.stringify(this.busjsondata[reqid]));
		else
		res.write(JSON.stringify({'id':reqid,'lat':0,'lon':0,'strinfo':reqid+"车 信号丢失",distanceNext:0,cspeed:0.01,avgspeed:0.01}));
		}

		res.end();
	
		
		
	});
	this.httpsserver.listen(8080);
	setInterval(()=>{
		let bus=this.world.getAllBUS()
		for(var i in bus){
if(!this.busjsondata[i])this.busjsondata[i]={};
				
			let loc=GPS.gcj_encrypt(bus[i].lat,bus[i].lon);
			
			let belongLines=[];
			for(var k in this.busBelongLine[bus[i].cid])
				belongLines.push(this.lines[this.busBelongLine[bus[i].cid][k]]);

			let nowline=this.busBelongLine[bus[i].cid][this.world.whichLineIsBus_gcj02(i,belongLines)];
			//if(bus[i].cid=="jinshan")
			//console.log(nowline)


			let nowstop=this.world.whereIsBUS_gcj02(i,this.lines[nowline]);
			
			let stoping="";
			let stopingid=-1;
			let forwardingSite="";
			let outofline=false;
			let redlighting=false;
			
			if(nowstop<0)
			{	outofline=true;
			nowstop=-nowstop;
			}
			if(!outofline)
		for(var j in this.targets[nowline])
			if((this.targets[nowline][j].type==1 ||this.targets[nowline][j].type==2)  && Math.abs(nowstop-this.targets[nowline][j].loc)<=1)//BUS在过站内,持续保持active
			{
				
				this.world.activate(i,100-bus[i].actived);
				stoping=this.targets[nowline][j].name;
				stopingid=j;
				}
		for(var j in this.redlights)
			if(Math.abs(nowstop-this.redlights[j])<=1)//等红绿灯
			redlighting=true;
		
			
		if(!outofline)
			for(var j in this.targets[nowline])
			{
				let prefix=1;
				if(this.busInfo[i])
				if(this.busInfo[i].vector>0)
				{
					if(nowstop>this.targets[nowline][j].loc)
						prefix=-1;
					else{
						prefix=1;
		
						}
						
				if(forwardingSite=="" && prefix==1)
				{forwardingSite=this.targets[nowline][j].name;
				this.busjsondata[i]["distanceNext"]=(this.world.getBUSDistance_gcj02(i,this.lines[nowline],this.targets[nowline][j].loc)).toFixed(2);
			
				}
				
				}else{
					if(nowstop>this.targets[nowline][j].loc)
						prefix=1;
					else
						prefix=-1;	
				
				if(prefix==1)
				{	forwardingSite=this.targets[nowline][j].name;
					this.busjsondata[i]["distanceNext"]=(this.world.getBUSDistance_gcj02(i,this.lines[nowline],this.targets[nowline][j].loc)).toFixed(2);
				}
				
				}
		
		
			//	console.log(this.world.getBUSDistance_gcj02(i,this.lines[nowline],this.targets[nowline][j].loc));
			this.busjsondata[i]["distance"+j]=(prefix*this.world.getBUSDistance_gcj02(i,this.lines[nowline],this.targets[nowline][j].loc)).toFixed(2);
			
			}
	
		
			
		let strinfo="     ";
	if(!this.busInfo[i])this.busInfo[i]={stop:-1,laststop:-1,state:-1,runloops:0,runmeters:0,runstops:{}};
		
		/*
		STATE对应表:
		-1:未确定
		0:等待出发
		1:接送路上
		2:返程路上

		*/		
		
		
		/*状态过渡判断*/
		if(this.busInfo[i].cspeed<3 && nowstop>=this.lines[nowline].length-1-1)
			if(this.busInfo[i].state==1)
				this.busInfo[i].state=2;
		if(this.busInfo[i].cspeed<3 && nowstop<=1)
			{if(this.busInfo[i].state==2)
				{this.busInfo[i].state=0;
				this.busInfo[i].runloops++;
				}
				if(this.busInfo[i].state==-1)
					this.busInfo[i].state=0;
			}
		if(this.busInfo[i].cspeed>5 && nowstop>1)
			if(this.busInfo[i].state==0)
				this.busInfo[i].state=1;
		
		let maxstop=this.lines[nowline].length-1;
if(this.busInfo[i].state==1 && !this.busInfo[i].runstops[nowstop])//首程
	if(nowstop==2)
		console.log(bus[i].cid,"阳光学院提醒您,,,道路千万条,安全第一条,行车不规范,亲人两行泪,,,欢迎微信搜索,校车在这,小程序,祝你旅途愉快")
	else
	if(this.targets[nowline][stopingid].type==2)
		console.log(bus[i].cid,"同学们,,,校车在这小程序提醒你,,,终点站"+stoping+"已经到了,请检查有没有遗落的物品再下车,下次乘车再见")
	else
	if(stopingid!="")
		console.log(bus[i].cid,"同学们,,,校车在这小程序提醒你,,,"+stoping+"已经到了,请检查有没有遗落的物品再下车")
	
if(this.busInfo[i].state==2 && !this.busInfo[i].runstops[nowstop])//返程
if(nowstop==2)
		console.log(bus[i].cid,"阳光学院提醒您,,,道路千万条,安全第一条,行车不规范,亲人两行泪,,,欢迎微信搜索,校车在这,小程序,祝你旅途愉快")
	else if(stopingid!="")
		console.log(bus[i].cid,"同学们,,,校车在这小程序提醒你,,,"+stoping+"已经到了,请检查有没有遗落的物品再下车")
	else if(nowstop==2)
		console.log(bus[i].cid,"同学们,,,校车即将抵达"+this.targets[nowline][0].name+",,,旅途即将结束,请检查好物品,下次乘车再见")
	
		
		if(this.busInfo[i].state==1)
		this.busInfo[i].runstops[nowstop]=true;
		else if(this.busInfo[i].state==2)
		this.busInfo[i].runstops[nowstop]=false;
		else
		for(let m=0;m<this.lines[nowline].length;m++)
		this.busInfo[i].runstops[m]=false;
	
		
			
		
		if(nowstop<1 && bus[i].actived<=0)//在老家休息
		strinfo+="       "+bus[i].name+"     \n 在阳光学院休息 等待出发";
		else if(nowstop<1)
		strinfo+=bus[i].name+"[speed]\n 在阳光学院范围内行驶";
		else if(bus[i].cspeed<3 && stoping.length>0)
		strinfo+=bus[i].name+"[speed]\n 在"+stoping+"接送乘客";
		else if(nowstop>=1 && nowstop<=20 &&  this.busInfo[i].vector>0)
		strinfo+=bus[i].name+"[speed]\n 发车 前往 → "+forwardingSite;
		else if(outofline)
		strinfo+=bus[i].name+"[speed]\n       偏离路线";
		else if(redlighting && bus[i].cspeed<3)
		strinfo+=bus[i].name+"[speed]\n       等待红绿灯...";
		else if(this.busInfo[i].vector>0)
		strinfo+=bus[i].name+"[speed]\n 正在前往 → "+forwardingSite;
		else
		strinfo+=bus[i].name+"[speed]\n 正在返回 ← "+forwardingSite;
	
	
		
		
		
	//	strinfo="校车在这系统维护中,预计明晚恢复正常,对您造成的不便请谅解"
//		if(this.busjsondata[i]["distanceNext"]>0)
		
		/*if(this.busjsondata[i]["distanceNext"])
		{
		let combine="";let nx=this.busjsondata[i]["distanceNext"];
		if(nx>1000)combine=(nx/1000).toFixed(1)+"km"
			else
				combine=parseInt(nx)+"m";
		//strinfo+="\n           "+(bus[i].cspeed*3.7).toFixed(0)+"km/h "+combine;
		
		}else{
			
			
		}*/
		
		if(bus[i].timeout>10*1000)
		strinfo=strinfo.replace("[speed]"," [信号不稳]");	
		else
		strinfo=strinfo.replace("[speed]","     "+(bus[i].cspeed*3.7).toFixed(0)+"km/h ");
		
		//信号丢失的时候按照平均速度模拟前进,超过30秒就算了
		if(bus[i].timeout>0 && !outofline && this.busStopInfo[i].stop>=2)
		{
		
			let MinOne=0;let MinValue=999999999;
			
			for(let k=nowstop;((this.busStopInfo[i].vector>0)?(k<this.lines[nowline].length):(k>=0));k+=(this.busStopInfo[i].vector>0?1:(-1)))			
			{
				if(k==nowstop)continue;
				let value=Math.abs(this.world.getBUSDistance_gcj02(i,this.lines[nowline],k)-bus[i].avgspeed*(bus[i].timeout/1000));
				if(value<MinValue)
				{MinValue=value;
				MinOne=k;
				}
			}
				//console.log(i,MinOne);
			
			loc.lat=this.lines[nowline][MinOne].lat;
			loc.lon=this.lines[nowline][MinOne].lng;
			
		}
			
			if(nowstop!=this.busStopInfo[i].stop)
			{this.busStopInfo[i].laststop=this.busStopInfo[i].stop;
			this.busStopInfo[i].stop=nowstop;
			}
			this.busStopInfo[i].vector=(this.busStopInfo[i].stop-this.busStopInfo[i].laststop)>=0?1:(-1);
		
			this.busjsondata[i]=Object.assign(this.busjsondata[i],{id:i,lat:loc.lat,lon:loc.lon,avgspeed:(bus[i].avgspeed+0.01).toFixed(2),cspeed:bus[i].cspeed.toFixed(2),stop:nowstop,percent:((nowstop/this.lines[nowline].length)*100).toFixed(2),actived:bus[i].actived.toFixed(2),strinfo:strinfo,vector:this.busStopInfo[i].vector,waiting:((bus[i].cspeed<3 && stoping.length>0)?"1":"0"),lastexecresult:bus[i].lastexecresult,name:bus[i].name,polyline:nowline});
			
		
		}

//console.log(this.busjsondata);
			
		
},updateRate);
	
	
	this.getStopMarkers=()=>{
		let markers=[];
		let kind=[
		"../../images/起.png",
		"../../images/中.png",
		"../../images/终.png"
		];

		let idcount=0;
		for(var nowline in this.lines)
		for(var i in this.targets[nowline])
		if(kind[i]){
		markers.push({id:idcount,iconPath:kind[i],latitude:this.lines[nowline][this.targets[nowline][i].loc].lat,longitude:this.lines[nowline][this.targets[nowline][i].loc].lng,width:8,height:10});
		idcount++;
		}
		return markers;
		
	}
	this.getPolyLine=()=>{
		let built=[];

		for(var nowline in this.lines)
{
		let item={points:[],color:this.linesInfo[nowline].color,width:5,borderWidth:5,
picwaiting:this.linesInfo[nowline].picwaiting,
picdriving:this.linesInfo[nowline].picdriving,
picrelax:this.linesInfo[nowline].picrelax,

};
		for(var i in this.lines[nowline])
		item.points.push({'latitude':this.lines[nowline][i].lat,'longitude':this.lines[nowline][i].lng});
		built.push(item);

}
		return built;
	}
	
	this.instruct=(id,func)=>{
		this.world.instruct(id,func);
	}
	this.playVoice=(id,str)=>{
		this.world.instruct(id,"return \"play[]"+Buffer.from(str).toString("base64")+"\"");
	}
	
}

let dataclient=new busdataclient(100);
const readline = require('readline');  
const rl = readline.createInterface({  
    input: process.stdin,  
    output: process.stdout  
});  

rl.on("line",(line)=>{
	let arr=[];
if(line.indexOf("...")!=-1){
if((arr=line.split("..."))){
	dataclient.instruct(arr[0],"return \"play[]"+Buffer.from(arr[1]).toString("base64")+"\"");
}
}

else{

	if(line.indexOf(",,,")!=-1)
	if((arr=line.split(",,,"))){
	//console.log(arr);
	dataclient.instruct(arr[0],arr[1]);

	console.log("send "+arr[0]+" func:"+arr[1]);
	}
}
})

/*

1189,,,return tostring(misc.getSn().."x".._G.PROJECT.."_"..rtos.get_version());
1189,,,update.request(nil,"t.cn/EJ7tmyF");return "yes";



1189,,,sys.restart("x");


*/

//39559,,,update.request();return "yes";



new streamserver();
new bbsServer();
console.log("Yango University School BUS 服务器已启动")

